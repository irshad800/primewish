<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Opsoon - Tailwind CSS Authentication</title>
    <meta name="description" content="Tailwind CSS Authentication Template" />
    <meta name="author" content="Zoyothemes" />

    <!-- Favicon -->
    <link href="assets/images/favicon.ico" rel="shortcut icon">

    <!-- Main CSS -->
    <link href="assets/css/style.css" rel="stylesheet" type="text/css">
</head>

<body>
    <!-- =========== Main Section Start =========== -->
    <section class="h-screen w-full">
        <div class="grid xl:grid-cols-2 grid-cols-1 h-full">
            <div class="max-w-lg mx-auto w-full flex flex-col justify-center md:items-start items-center p-6">
                <div class="md:text-start text-center mb-7">
                    <a href="index.html" class="grow block mb-8">
                        <img class="h-8 md:mx-0 mx-auto" src="assets/images/light-logo.png" alt="logo">
                    </a>

                    <div class="md:text-start text-center">
                        <h3 class="text-2xl font-semibold text-dark mb-3">Welcome to Opsoon</h3>
                        <p class="text-base font-medium text-light">Welcome back! Log in to continue.</p>
                    </div>
                </div>

                <!-- LOGIN FORM -->
                <form class="text-start w-full" onsubmit="event.preventDefault(); loginUser();">
                    <div class="mb-4">
                        <label for="loginUsername" class="block text-base font-semibold text-dark mb-2">Username</label>
                        <input id="loginUsername" class="block w-full rounded-md py-2.5 px-4 text-dark text-base font-medium border-gray-300 focus:border-primary focus:outline-0 focus:ring-0 placeholder:text-light placeholder:text-base" type="text" placeholder="Enter your username">
                    </div>

                    <div class="mb-4">
                        <label for="loginPassword" class="block text-base font-semibold text-dark mb-2">Password</label>
                        <div class="flex">
                            <input type="password" id="loginPassword" class="text-dark text-base font-medium block w-full rounded-s-md py-2.5 px-4 border border-gray-300 focus:border-primary focus:outline-0 focus:ring-0 placeholder:text-light placeholder:text-base" placeholder="Enter your password">
                            <button type="button" data-hs-toggle-password='{"target": "#loginPassword"}' class="inline-flex items-center justify-center py-2.5 px-4 border rounded-e-md -ms-px border-gray-300">
                                <i class="hs-password-active:hidden h-5 w-5 text-dark" data-lucide="eye"></i>
                                <i data-lucide="eye-off" class="hidden hs-password-active:block h-5 w-5 text-dark"></i>
                            </button>
                        </div>
                    </div>

                    <div class="flex justify-between items-center flex-wrap gap-x-1 gap-y-2 mb-6 mt-3">
                        <div class="inline-flex items-center">
                            <input type="checkbox" id="checkbox-signin" class="h-4 w-4 rounded border-gray-300 text-dark focus:ring focus:ring-default-950/30 focus:ring-offset-0">
                            <label class="text-base ms-2 text-light font-medium select-none" for="checkbox-signin">Remember me</label>
                        </div>
                        <a href="auth-recoverpw.html" class="text-base text-dark"><small>Forgot your password?</small></a>
                    </div>

                    <!-- LOADER & MESSAGE -->
                    <div id="loginLoader" style="display: none; text-align: center;">
                        <span>Loading...</span>
                    </div>
                    <p id="loginMessage" class="text-center text-red-500 mt-2"></p>

                    <div class="text-center mb-7">
                        <button type="submit" class="w-full inline-flex items-center justify-center px-6 py-2.5 bg-primary font-bold text-base text-white rounded-md transition-all duration-500">Log In</button>
                    </div>

                    <p class="text-light text-center">Don't have an account? <a href="auth-register.html" class="text-dark font-semibold ms-1"><b>Register</b></a></p>
                </form>
            </div>

            <div class="hidden xl:block">
                <div class="relative w-full h-screen bg-[url('/assets/images/image1.png')] bg-center bg-cover"></div>
            </div>
        </div>
    </section>
    <!-- =========== Main Section End =========== -->

    <!-- Preline Js -->
    <script src="assets/libs/preline/preline.js"></script>

    <!-- Lucide Js -->
    <script src="assets/libs/lucide/umd/lucide.min.js"></script>

    <!-- Main App Js -->
    <script src="assets/js/app.js"></script>

    <!-- LOGIN FUNCTION -->
    <script>
        async function loginUser() {
    const username = document.getElementById("loginUsername").value;
    const password = document.getElementById("loginPassword").value;
    const loader = document.getElementById("loginLoader");
    const message = document.getElementById("loginMessage");

    // Clear any previous messages
    message.textContent = "";

    if (!username || !password) {
        message.textContent = "Username and password required!";
        message.style.color = "red";
        return;
    }

    loader.style.display = "block"; 

    try {
        const response = await fetch("http://localhost:8080/api/auth/login", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ username, password })
        });

        const data = await response.json();
        loader.style.display = "none"; 

        // Handle success or failure based on backend response
        if (response.ok && data.success) {
            localStorage.setItem("authToken", data.token); // Store token securely
            message.style.color = "green";
            message.textContent = data.message || "Login successful!";
            window.location.href = "dashboard.html"; // Redirect after login
        } else {
            message.style.color = "red";
            message.textContent = data.message || "Login failed. Please check your details.";
        }
    } catch (error) {
        loader.style.display = "none"; 
        message.style.color = "red";
        message.textContent = "An error occurred while logging in. Please try again.";
    }
}

    </script>
    

</body>
</html>
